@using Microsoft.AspNetCore.Identity
@using VZTest.Models.Test
@model IEnumerable<TestStatistics>
@{
    ViewData["Title"] = "Ваши тесты";
}

<script>
    function SetClipboard(content)
    {
        navigator.clipboard.writeText(content);
        document.getElementById('copyIcon').setAttribute('class','bi bi-check2');
        var interval = setInterval(function(){SetIconBack()},2500);
    }

    function SetIconBack()
    {
        document.getElementById('copyIcon').setAttribute('class','bi bi-clipboard-check');
    }
</script>

<h2><i class="bi bi-list-stars"></i> @ViewData["Title"]</h2>
<hr>

@if (Model.Count() > 0)
{
    @foreach (TestStatistics test in Model)
    {
        <div class="container">
            <h5><a class="link" asp-controller="Test" asp-action="Priview" asp-route-Id="@test.Test.Id">@test.Test.Title</a></h5>
            <div class="row col-12">
                <div class="col-3">
                    <h6>Номер: #@test.Test.Id <a class = "btn btn-outline-primary btn-sm" onclick = "SetClipboard(@test.Test.Id)"><i id = "copyIcon" class="bi bi-clipboard-check"></i></a></h6>
                </div>
                <div class="col-3">
                    <h6>Создано: @test.Test.CreatedTime.ToString("dd.MM.yyyy")</h6>
                </div>
                <div class="col-3">
                    <h6>Вопросов: @test.QuestionCount</h6>
                </div>
                <div class="col-3">
                    <h6>Пройдено: @test.AttemptsCount @WordHelp.Inflect(test.AttemptsCount,"раз","раз","раза")</h6>
                </div>
            </div>
            <div class="text-end">
                <form method= "post" asp-route-Id = "@test.Test.Id">
                <button class = "btn btn-outline-success" type = "submit"><i class="bi bi-file-earmark-text"></i> Результаты</button>
                <a class="btn btn-outline-warning" asp-controller = "Test" asp-action = "Edit" asp-route-Id = "@test.Test.Id"><i class="bi bi-pencil"></i> Редактировать</a>
                @if (test.Test.Opened)
                {
                    <a class="btn btn-outline-warning" asp-controller = "Test" asp-action = "Close" asp-route-Id = "@test.Test.Id"><i class="bi bi-door-closed"></i> Закрыть</a>
                }
                else
                {
                    <a class="btn btn-outline-success" asp-controller = "Test" asp-action = "Open" asp-route-Id = "@test.Test.Id"><i class="bi bi-door-open"></i> Открыть</a>
                }
                <a class="btn btn-outline-danger" asp-controller = "Test" asp-action = "Delete" asp-route-Id = "@test.Test.Id"><i class="bi bi-trash"></i> Удалить</a>
                </form>
            </div>
        </div>
        <hr>
    }
}
else
{
    <h5>Вы пока не создали ни одного опроса.</h5>
}